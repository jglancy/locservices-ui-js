define(["jquery","locservices/ui/component/component","locservices/core/recent_locations","locservices/core/preferred_location"],function(a,b,c,d){"use strict";function e(b){var e=this;b=b||{},b.componentId="user_locations",this.setComponentOptions(b),this.preferredLocation=new d,this.recentLocations=new c,this.element=f,this.element.on("click",function(b){var c,d;b.preventDefault(),c=a(b.target),c.hasClass("ls-ui-user_locations-remove")&&(d=c.parent().attr("href").split("=")[1],e.removeLocationById(d))}),this.render()}var f=a("<div />").addClass("ls-ui-user_locations"),g=function(b,c){return a("<li />").text(b.get("user_locations.heading")+"("+c+")")};return e.prototype=new b,e.prototype.constructor=e,e.prototype.setPreferredLocationById=function(a){var b,c,d,e;for(c=this.getLocations(),e=c.length,d=0;e>d;d++)a===c[d].id&&(b=c[d]);b&&(this.preferredLocation.set(b),this.render())},e.prototype.removeLocationById=function(a){this.recentLocations.remove(a),this.render()},e.prototype.render=function(){var a,b,c,d,e,f="";if(a=this.getLocations(),c=a.length,this.element.append(g(this.translations,c)),c>0){for(f="<ul>",d=0;c>d;d++)b=a[d],e=b.name,b.container&&(e+=", "+b.container),f+='<li><a href="?locationId='+b.id+'">'+e+'<span class="ls-ui-user_locations-remove">remove</span></a></li>';f+="</ul>"}this.container.append(this.element)},e.prototype.getLocations=function(){var a,b,c,d,e,f=[],g=5;if(this.preferredLocation.isSet()&&(g--,a=this.preferredLocation.get(),f.push(a)),this.recentLocations.isSupported()&&(b=this.recentLocations.all(),c=b.length,c>0))for(e=0;c>e&&(d=b[e],g>0&&(!a||a&&a.id!==d.id)&&(g--,f.push(d)),0!==g);e++);return f},e});